# 队列（Queue）

<!-- toc -->
- [队列（Queue）](#队列queue)
  - [初步了解队列](#初步了解队列)
    - [队列的定义](#队列的定义)
    - [队列的主要元素](#队列的主要元素)
    - [队列的溢出](#队列的溢出)
    - [队列的主要应用](#队列的主要应用)
  - [队列的抽象数据类型](#队列的抽象数据类型)
  - [队列的实现方式](#队列的实现方式)
    - [顺序队列（Sequential Queue）](#顺序队列sequential-queue)
      - [顺序队列的特点](#顺序队列的特点)
      - [循环队列的实现方法](#循环队列的实现方法)
      - [顺序队列的代码实现](#顺序队列的代码实现)
    - [链式队列（Linked Queue）](#链式队列linked-queue)
      - [链式队列的特点](#链式队列的特点)
      - [链式队列的代码实现](#链式队列的代码实现)
    - [顺序队列与链式队列的比较](#顺序队列与链式队列的比较)
    - [双端队列（Deque）](#双端队列deque)
      - [双端队列的特点](#双端队列的特点)
      - [双端队列的特化](#双端队列的特化)
  - [队列的应用](#队列的应用)
    - [车厢重排问题](#车厢重排问题)

## 初步了解队列

### 队列的定义

队列是一种允许在一端（队尾，rear）进行插入操作，在另一端（队首，front）进行删除操作的线性数据结构。队列的这种操作特性使其成为一种FIFO（先进先出）的数据结构。

### 队列的主要元素

1. **队首（Front）**：队列的这一端用于移除元素。当队列非空时，可以从队首取出元素。
2. **队尾（Rear）**：队列的另一端，用于插入元素。新加入的元素总是被放置在队尾。

### 队列的溢出

- 上溢（Overflow）
尝试向一个已满的队列中添加元素时，在固定大小的队列中尤为常见。

- 下溢（Underflow）
尝试从一个空队列中移除元素时。

- 假溢出（False Overflow）
顺序队列特有的一个现象，发生在使用数组实现的队列中。当队列前端的空间被清空（即前面的元素已经出队），而后端由于达到数组的物理边界而无法再进行入队操作时，即使数组中还有未使用的空间，也会发生溢出情况。

### 队列的主要应用

- **调度和缓冲**：在操作系统中执行各种调度任务，如CPU调度、打印作业排队等。在网络通信中，作为数据包的缓冲区，帮助控制数据流量和处理网络拥塞。
- **消息队列**：存储待处理的消息，确保按照接收顺序进行处理。
- **邮件队列**：管理待发送或接收的邮件，以维持邮件的处理顺序。
- **数据流管理**：在流媒体、实时数据传输等场景中管理数据包。
- **硬件设备通信**：管理设备间的通信，例如打印机任务队列、硬盘I/O请求队列等。
- **资源管理**：操作系统使用队列进行资源分配和管理，如内存管理、进程管理等。
- **广度优先搜索（BFS）**：在图和树结构的搜索中实现广度优先搜索。

## 队列的抽象数据类型

1. 数据对象
   - 集合 \(\{ a_i | a_i \in \text{ElemSet}, i = 1, 2, \ldots, n, n > 0 \}\) 或空集 \(\Phi\)，其中 \(\text{ElemSet}\) 是元素的集合。

2. 数据关系
    - 队列中的元素之间存在顺序关系 \(\{<a_i, a_{i+1}> | a_i, a_{i+1} \in \text{ElemSet}, i = 0, 1, \ldots, n-2 \}\)，表示每个元素 \(a_i\) 都在 \(a_{i+1}\) 之前。

3. 基本操作
    - `InitQueue(queue)`：初始化一个空的队列 `queue`。
    - `DestroyQueue(queue)`：销毁队列 `queue`，释放其占用的所有空间。
    - `Clear(queue)`：清空队列 `queue`。
    - `IsEmpty(queue)`：如果队列 `queue` 为空，则返回真（true）；否则返回假（false）。
    - `IsFull(queue)`：如果队列 `queue` 已满，则返回真（true）；否则返回假（false）。
    - `GetFront(queue)`：返回队列 `queue` 的队首元素，但不改变队首元素。
    - `EnQueue(queue, x)`：将元素 `x` 插入队列 `queue`，成为新的队尾。
    - `DeQueue(queue)`：将队首元素从队列 `queue` 中删除。

4. 代码实现

见`The ADT of Queue.cpp`文件。

## 队列的实现方式

### 顺序队列（Sequential Queue）

队列的元素按顺序存储在一块连续的内存空间（通常是数组）中。这种实现方式与顺序栈类似，但遵循的是先进先出（FIFO, First In First Out）的原则。

#### 顺序队列的特点

1. **固定大小**：顺序队列通常有固定的容量，这个容量在队列初始化时确定。
2. **连续存储**：队列中的元素在内存中连续存放。
3. **队首和队尾指针**：使用两个指针或索引来标识队列的队首（front）和队尾（rear）。
4. **循环使用空间**：为了有效利用空间，顺序队列通常作为**循环队列**实现，当达到数组的末尾时，如果前面有空闲空间，则从数组的开始处继续使用空间。

#### 循环队列的实现方法

| 方法               | 队空判定           | 队满判定                           | 特点                                                         |
| ------------------ | ------------------ | ---------------------------------- | ------------------------------------------------------------ |
| 虚指针法           | `front == rear`    | `(rear + 1) % M == front`          | 使用一个位置来区分队满和队空，牺牲了一个存储空间。             |
| 实指针法           | `front == rear`    | `(rear + 2) % M == front`          | 保留一个空位作为队满的标志，更充分地利用空间。               |
| 额外标记法 | `front == rear` 且 `count == 0` | `front == rear` 且 `count == MAX_SIZE` | 使用额外标记（如计数器）区分队满和队空，完全利用所有空间，逻辑稍复杂。 |

#### 顺序队列的代码实现

使用虚指针法，见`Sequential Queue.cpp`文件。

### 链式队列（Linked Queue）

队列的元素不是连续存储的，而是每个元素通过指针链接在一起。这种实现方式相比于顺序队列（使用数组实现的队列），具有更好的扩展性和灵活性。

#### 链式队列的特点

1. **动态大小**：链式队列的大小不是固定的，可以根据需要动态增长或减少。
2. **非连续存储**：队列中的元素通过指针链接，每个元素（节点）包含数据和指向下一个节点的指针。
3. **队首和队尾指针**：使用两个指针分别指向队列的队首（front）和队尾（rear）。
4. **空间利用**：链式队列按需分配空间，不会预先分配未使用的空间，因此具有高效的空间利用率。
5. **操作复杂度**：入队（Enqueue）和出队（Dequeue）操作的时间复杂度都是 \(O(1)\)。

#### 链式队列的代码实现

见`Linked Queue.cpp`文件。

### 顺序队列与链式队列的比较

| 特性           | 顺序队列                                               | 链式队列                                               |
| -------------- | ------------------------------------------------------ | ------------------------------------------------------ |
| **内存分配**   | 静态分配：通常需要预先分配固定大小的数组               | 动态分配：根据需要分配节点，每个元素独立分配           |
| **容量限制**   | 有固定的容量，超出容量时需处理溢出问题                 | 无固定容量，理论上受限于系统内存                       |
| **存储方式**   | 连续存储：所有元素在内存中连续存放                     | 非连续存储：元素通过指针链接，分散存储                 |
| **空间效率**   | 可能有空间浪费（预分配但未使用的空间），或面临扩展问题 | 高空间利用率，按需分配，无空间浪费                     |
| **时间效率**   | 入队和出队操作通常较快（直接索引）                     | 入队操作快（尾部插入），出队操作也快（头部删除）       |
| **实现复杂度** | 相对简单，特别是不涉及循环逻辑时                      | 略高，需要处理节点的动态分配和链接                     |
| **适用场景**   | 当队列大小可预知且变动不大时                          | 当需要频繁的动态调整队列大小时                         |

### 双端队列（Deque）

双端队列（Double-Ended Queue，简称 Deque）是一种特殊的队列，它允许在队列的两端（前端和后端）进行插入（入队）和删除（出队）操作。双端队列结合了栈和队列的特性，使得元素可以在两端被加入或移除。

#### 双端队列的特点

1. **两端操作**：支持在队列的前端和后端进行元素的插入和删除。
2. **灵活性**：由于支持两端操作，双端队列可以作为普通队列或栈使用。
3. **实现方式**：可以通过数组或链表实现，循环数组实现的双端队列特别常见。

#### 双端队列的特化

- 超队列（Super Queue）
删除受限：在超队列中，删除操作仅限于一端进行。这意味着，尽管可以从队列的任一端插入元素，但删除元素只能从固定的一端执行。

- 超栈（Super Stack）
插入受限：在超栈中，插入操作仅限于一端进行。尽管可以从两端删除元素，但插入元素只能在固定的一端执行。

## 队列的应用

### 车厢重排问题

见`Lab 1_5 车厢重排问题.cpp`文件。
